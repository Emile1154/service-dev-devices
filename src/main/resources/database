-- Table images
CREATE TABLE images(
    id BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    icon64 TEXT(9000) NOT NULL
)
ENGINE=InnoDB;

-- default logotype
INSERT INTO images VALUES (null,'iVBORw0KGgoAAAANSUhEUgAAAVwAAAFcBAMAAAB2OBsfAAAAG1BMVEXu7u4AAAD///8pKSmhoaHKyspUVFR2dnb39/cH0OCgAAANoklEQVR42tWdS3fiuBKAHc/0bZYoNriXbgWClxeSfiwv9GuWwdOPWQ50msxyYPqxpT3Tc/KzLzaEYFs2UqlUglrFOcf2h1wqlUqlksPXEjprgV820j+Xb799+3jRZyvxLmbfbl6t/6v35N1LnKesqMJ3bz4ygVx8fuemxIeDm3D+dtZnleLNXnF+MLj8x+sa1g3xtXsguN3XTEqu4wPA7f7FpOVZbBlXtmV3WnhpCzfhH/pMUbwvSWQFt8F/TBhA2r9lDUyMm0TvGVA+pQ1Mi8u7EwaWIOakuA3+sM80xPuTE+JG/D3TlE+UrfuCacslGW44ZwgSuGB77zibEZ3vv0x0OlnOosWRynuzS2XcpNNnSOKNItO4iLQZr1lcVNqUl5vERabd4TWC20WmXfHG5nBDdNqVfXCN4c6ZAQlM4Q6ZEfHN4P7KDMkTE7j/MmPyBz5uhxmUETauCaOwY87cJS7unBmVgGPiJj8xw/IkksOVcjR7zLiM8Nxzs4p7p75ouENGID4Wbo+RyBQHl0IV7tQBAXfIiMTHwO0xMlno40Z9Olwv0cYdM0JpRZq4HUYqo1APd06L2+Y6uO45I5bnoQZu2KfG9Vw4bjJm5LLubRDcRodZkNESGoEc2sD1oe65lcZde74Q3Lkd3ACG22OWZAHCndvCDSC41ho3bV513Lk93EAd12Ljrpp3qYo7t4kbRIq4Vht327yyuMnQLq4fqeA2OsyyZJ6DLK7txl01b6iA22XWJZbHdU/s4zZD+Qhk3z6uJ++en7MDkKk07vwQcNuyuB12EDKSxB0fBm5LDjdiByKJFO7ZoeAOpHDnh4IbyODqd7Sns28vX36bfUQL8NXgRpojWvuVu83AeztBGNn2tK7WiPYs5jlRSUYWjWx7cXVGNO8LT/K4ESDFd3dkW+7D1XAd2y4XSKihEX64BzeEP/uSV4hGxmRcj9uAG90nvFLgeSaDZX0Ecm6AVoPXr3fPwbrgR3W48MmUW4sL1YWA7xHoVxvU4gKf6sX7cKH5fUEd7hIe4twnPR1tqMAF6kKLS8hYQxsqcGE9os2lZAK3DWLcyJgqaKhDUol7rmMb9wvs200rcWHqFcvidsEdQ4zbN9bPNHqbV4XbMdu40OYdVeA+Nty4wOY9rcCdG25cYPMGYtzQqFnQMA6uKAIJc3UXargg2ztYCtxzd2xuQNMb2lqhADeBmLGBKi7kE3qRALcDUytFCYGmrIgLUl2fK8tQ4xvu4LqQ50zVcc81WmUHF6S6iTouxOvzyrgdGl2AaUNcxI3OKOwC1DYMirigH+1CcCG2oVXCBahuwEEyByvvPS7E+XgEw/0OVt57XIh9WcBwe2CLeY97QmPGoKasWcCdk6muxru2EcgQ/IsBAvmSjZx73gHrE6cZh0e7uCD/Jobi/oDGpe9wIa65x8ECsPGtcBd3QtjTQH2tvYtL2tNgfc3dwYVY7gEcF9JTFve4oJ42guP2gH1tgwuaBMdwXIiDkva1O1zIdJprCCSWc497y0jtGCzUebvFhXwcXwcXNAHa4kJGxZYGLShnYnqH2/hOa3ZhodlHyw0uyDAMqHH98C4CCTEMUx1ciPa1t+45ox0lgMsKd7jd48CNN7g9RjuowTze9bZc6Eqwq4MLCpsONrig9ZhEBxe0mtva4A5hik/sNKzG0TXu5Dhw2xtcyL2eHm4f1EIZbvdYcOMMt3csuIsM9+xYcAcZ7uNjwT0N4SUN6C1DNl2D5pxYwM3yTUHzShujWupCwuaVVnyGdaYAcLMXvUeWvhMW2rXi767Llp1bwP0H9s7pCvcMeivxXC3zeJ3GY+itxDPhdJzgsFm7jThD9k7HhY0SWlEcUDw6c9ChowR9jCxbXwDjkkcgs2HNcYG3MnKXIdsDBE03p46er5sIvuF6RD6opcs/YFzilZ9NSBr8S5vkdixdGQbXjaBdtdxMLh3wdjqP3I6tFNCB7/iKyQ3DCvcx+N4psT+Wrk9o4DbJe9oK9zsj72tzeAs58J9Kmel05wY6Y/jNhHlkW9wh/GbCLL07r9WBKxJhDuT2jTq4dBmmW4dXC3dA6t9o45JlR98rw0TjbkY4k9i0bl/n9inlCJy6VXq4Pq0u6OIS7UpBwx1Q2oUUV+t2mh1VO6KJS7JfDRHXJ+xoCLgEey1Rcc3vZEXFNb9PGBe3Rdi4CLim97hj4/pUZgEH13B9hjxuX/8ZkuEnjDdh4NaX8MHrZ1i4Jiu3FHAnKI/Z60jiVP9HwjVXdQhzailvzYbssHANVcwyhmumHhlqFCcvJqq9lXCHaM8yUEuvHNIb4z0srVRYkg99hol7wjAFtw6kIL77neEKZpXNkjQ1llIqBa2GaUkemcA1J4+cs2PCHRwX7tTpHRPuwukcE+7oEMrzK0y6jwvXhacO2RCNxCwL4sHT3mxI+7hwA3jKpg3x4QmxNqQJTze2IafwZG4rHg48Vd6KhwPfiGDFZeCO5rIn8Rjs6K3Yi4ae2edX767evXv7ZoY9YEYpLuI40b652k6Cs7StB18xn55uAIvQxonr33jxRITV5YPXaKNEiHdicBoSEefBJVihkRZ886IAtk5QgE/hW0Pzcrk/eo4Q1xvAN97mmlYqa76j3ekW8G3NSk2L1MAxfNP4vfwpvyb8UHPqo7Elf6sIkTxu0tHpcW2dggebRygmoHc1msbXKSexplVPzILztnSKdWS0gPzoCMw70CmFks70QNnc0RxqxzZ1ILtUmqCnD/GmSBJsH7YXw2h5BDw35XaDCws1UG8AW7mPGiWoFlxDIL3Fv8NtfFe/+QnXEsCy67bAF2AyHHBNUTcP2/JpjvKGfs/VxVVPx7gvTndLqrhA9b0v/ecqfpoWRxDF/r1TWFHRNLQ5iqiZz52ylYpFQUc4uGrWd6coqNriWpMjidI3XQAL2rYjLFwldXCB5YIXaLQq1iFXLlihr/l4tCoBpLtizKrbGWJEXIVJeLZBY1umvUNqcgG9bZTDlZ68u7i40n2c53Elx7X/cmT5ScWlUj1iwEuwcaO+gq1XPcDhOUeXvyUXUfK4Un3U4wakL2+PFA8feW4C92/5dlI82iUxgRvKm0+1g3Oa3IicSA4SqscSxWZwu9JvVjr0qcUNyVi2iysdqTUyhduRdatUDiwLuDGZy6mu0nFwU3O455LfNXcWdp9+iJAz+p7woMixDSsmY8taQtxzOx1tf2ebqh/DGXCjMq/3sZUPOR2YxT2rbynlI2Rds7h1X/ZU/YBenxuWYW2vUT3+eGoa97zWgqoeLs2NS62ronh0t28ed1j3YRUPRp+axz2vmxMoHjvvmscN6z5sBe6ZNV2obKpBDW5oZYyoHSncGtyKgS2mwO3WDP6Cs7Cro/5tTiKTqhj/jlOexxUvvjdpcE8qVtNqcJOh2Xi5aiw9CGtxhdrAiaRSFypxRYsqPhXuULyAUocruOeUCvexKClgD26PdtpTPwWaLvfhlr1Izm0p73YKXIN7Ykt1y8rbDPfjdmypbll5RxK4xYF4RIfbKQ7AMrhnBDHoinUVQVreXtzIhsMgchsSKdz8lK1JiXtSmKRJ4XYs9bRCXxuJcPP+bmbokglV5LEuEtmO8lQi93ydtXdGPpUQTCgGoSSuk1v59MhMQ+G1jiyue2Kls52URjQ53MKkIqah7ZanEZK4+UlFiwZ3XHYdJXEbHfpxuPDKpQJuoXkDCtycq+JHjgqu27MbI1ss1XDzP1Y/AXZviCw3KwgiRxG3x0h721jUuAq4Bbd3QdnPAu4o4/Yo/chJoW3UcQvN26RThYBDcHtkoadO6U2VuAJ/d3OZzKnUIa8KQeRUU1XjFoY2smyRdEAD4JbCkVOKAWI9oEFwi81rxjUrhpQzbwGC6yRjgjB6IWjeihworlPcO2IgADUs7ndx4LhucXHud2za/xTzFkMNXKe0FIRsfXulVRtHC7djNNpbfnqoh1tahfcQzUNpF2MrcjRxS+nL0B2hAh93Ukq+DnVxy9F/yO5gYVhhUl4R08ctL64EKLzl/cI+x8Bd9k3wlmnTGRYCriAzQl8fBHvHp4kEbrW/u70UrLW1Ne2DoJKAz/dg7HHPt5cNwbZpPV4BrRcvkXCdRJRh9gucVnRY8yJ0sHCdRLTX5ROU9r1om3Tk4OG6wjSSZ6ABI/xLmBTioOIKtyG3AQ6EsN6M5y5xcSsSJC9VaV9UpDk6yLj8X3GG4v9UYH8WZ1n+wfFxq3b9P5M2aVV1r59wE7iVOXyXUsDdF1J5eHi41enTN3uBu1/r08RN4NZUKdipHy6wXTUVxTfuswlcXlvEZPZFSBx+mNXtiYi5Odx9RZkubl5dNe5Jl1dvv17U7+AYcYO4jlQRqYuns5V8vJDY5bcdZ2RxJfzd3CWwqE2VJki/V949z1/i8aZ6axxXq0hXyWU2j8vDOQZt4HIaXJSyg5eQ98JwI6GHrSSfOB1u2OAPtTqct60XSIK7+qurocBBzB1aXCeJwArxKYkcalynwf8BWbT2L3zp0OOuGhhQSdX7kkTKL8LBTQuKKhbXvY750rGHq3aSz7NY40U4uPItfB1rvggHlyc/Xu/VYe/ajTgCrpq/W3n589caYu9mNb2PMF6EhbuSB2+EDvnTz1e6TzaCu5LbBy+/zmYXWUN7q0nFzcurW47w5O3l/wHlspeBww/7egAAAABJRU5ErkJggg==');
-- Table users
CREATE TABLE users(
    id BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    nickname VARCHAR(255) NOT NULL UNIQUE,
    email VARCHAR(255) NOT NULL UNIQUE,
    phone VARCHAR(255) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    account_non_locked BIT NOT NULL DEFAULT 1,
    active BIT NOT NULL DEFAULT 0,
    activation_code VARCHAR(255) UNIQUE,
    image_id BIGINT NOT NULL DEFAULT 1,
    FOREIGN KEY (image_id) REFERENCES images(id)
)
ENGINE=InnoDB;

-- Table roles
CREATE TABLE roles(
    id BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL
)
ENGINE=InnoDB;

-- Table for mapping users and roles
CREATE TABLE user_roles(
    user_id BIGINT NOT NULL,
    role_id BIGINT NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (role_id) REFERENCES roles(id),
    UNIQUE (user_id,role_id)
)
ENGINE=InnoDB;

-- Table orders
CREATE TABLE orders(
    id BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    title VARCHAR(255) NOT NULL UNIQUE ,
    description TEXT(1000) NOT NULL,
    order_status VARCHAR(20) NOT NULL,
    price DECIMAL(5,2),
    created TIMESTAMP,
    updated TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
)
ENGINE =InnoDB;

CREATE TABLE payments(
    id BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    token VARCHAR(255),
    created TIMESTAMP,
    updated TIMESTAMP,
    pay_status VARCHAR(20),
    pay_method VARCHAR(20),
    user_id BIGINT NOT NULL,
    order_id BIGINT NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (order_id) REFERENCES orders(id)
)
ENGINE = InnoDB;

-- insert data
INSERT INTO users VALUES (null,'admin', 'laim778@yandex.ru', '+7(996)404-45-13',
                          '$2a$12$25GU6Wki1S3HpZbZNt.BhObLYg4423s.h3xl/8lGMJi2YZK5/lJxS', 1,1 , null,1);
INSERT INTO roles VALUES (1, 'ROLE_USER');
INSERT INTO roles VALUES (2, 'ROLE_ADMIN');
INSERT INTO roles VALUES (3, 'ROLE_MANAGER');
INSERT INTO user_roles VALUES (1,2);
